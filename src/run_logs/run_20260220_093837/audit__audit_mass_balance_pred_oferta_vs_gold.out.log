[2026-02-20 09:42:12] STEP audit:audit_mass_balance_pred_oferta_vs_gold
script=C:\Users\paul.loja\PYPROYECTOS\Data-LakeHouse\Data-LakeHouse\src\audit\audit_mass_balance_pred_oferta_vs_gold.py
cmd=C:\Users\paul.loja\PYPROYECTOS\Data-LakeHouse\Data-LakeHouse\venv\Scripts\python.exe C:\Users\paul.loja\PYPROYECTOS\Data-LakeHouse\Data-LakeHouse\src\audit\audit_mass_balance_pred_oferta_vs_gold.py
cwd=C:\Users\paul.loja\PYPROYECTOS\Data-LakeHouse\Data-LakeHouse
PYTHONPATH=C:\Users\paul.loja\PYPROYECTOS\Data-LakeHouse\Data-LakeHouse;C:\Users\paul.loja\PYPROYECTOS\Data-LakeHouse\Data-LakeHouse\src
OPS_ARTIFACTS_DIR=C:\Users\paul.loja\PYPROYECTOS\Data-LakeHouse\Data-LakeHouse\data
OPS_LOG_DIR=C:\Users\paul.loja\PYPROYECTOS\Data-LakeHouse\Data-LakeHouse\src\run_logs\run_20260220_093837
outputs: (none) => no-skip mode

================================================================================
[A] DUPLICADOS pred_oferta_dia
================================================================================
rows=108,530 | dup_rows_by_key=22,308 | dup_rate=0.2055

Top duplicated keys (count):
ciclo_id                                  fecha       bloque_base  variedad_canon
001f32a7c3376fcfe35b921a4b1e82fcf3804fd2  2024-05-06  338          XLENCE            2
                                          2024-05-07  338          XLENCE            2
                                          2024-05-08  338          XLENCE            2
                                          2024-05-09  338          XLENCE            2
                                          2024-05-10  338          XLENCE            2
                                          2024-05-11  338          XLENCE            2
                                          2024-05-12  338          XLENCE            2
                                          2024-05-13  338          XLENCE            2
                                          2024-05-14  338          XLENCE            2
                                          2024-05-15  338          XLENCE            2
                                          2024-05-16  338          XLENCE            2
                                          2024-05-17  338          XLENCE            2
                                          2024-05-18  338          XLENCE            2
                                          2024-05-19  338          XLENCE            2
                                          2024-05-20  338          XLENCE            2
                                          2024-05-21  338          XLENCE            2
                                          2024-05-22  338          XLENCE            2
                                          2024-05-23  338          XLENCE            2
                                          2024-05-24  338          XLENCE            2
                                          2024-05-25  338          XLENCE            2

================================================================================
[B] CONSISTENCIA tallos_proy
================================================================================
ciclos total=623 | ciclos con tallos_proy variable=0 (0.00%)

================================================================================
[C] MASS BALANCE en pred_oferta_dia (baseline vs tallos_proy)
================================================================================
count    623.0
mean       0.0
std        0.0
min        0.0
50%        0.0
90%        0.0
95%        0.0
99%        0.0
max        0.0
max_abs_diff=0.000

Top 20 ciclos peor diff (pred_oferta_dia):
                                ciclo_id       proy_any      base_sum  abs_diff
e6dda64356ffd47c87837ad6ef2850248800c900       180580.4 180580.400000       0.0
de7f240a0f1f4cfab381ee4977ab54b937e1d5b8  190323.145833 190323.145833       0.0
cd589b8415ce3f293c3662c8d0bc67b7071390d3       195840.0 195840.000000       0.0
c93a387bc74caadbdffb6ac0a6c1c22d58466e7b       180320.0 180320.000000       0.0
c8c94554decd4ec255e90c4136c61393e6d61fc2       189220.0 189220.000000       0.0
c8c739b3e36b2df00f7ca8e3a01d45ca73fae05c       221960.0 221960.000000       0.0
be2cee7748abefb9876caaef83dc342977e3da7a  260483.401233 260483.401233       0.0
921d6d2420074263f394a8ed53ade3f06f9d5f15       261860.0 261860.000000       0.0
8a0c665f14c56cd720312963fb76095fb68cb6ec       214740.0 214740.000000       0.0
80cc0cac238470f4e0c4ee1fbb37a059d4e6c885       194500.0 194500.000000       0.0
7e02cb388409f6a86b03654716e50983f0ec21e2   184832.90375 184832.903750       0.0
7d9323a619f8fccf99a30cfc03e4dbf71034bb98      187809.65 187809.650000       0.0
5fc271b62c6cd39969efb03c99202bf60f606443      232395.97 232395.970000       0.0
54072fb26211d5890becd207ef5c2906c1aefc93       202360.0 202360.000000       0.0
3954d5106f3d522d62f823b053f226863ab0660f   230161.66975 230161.669750       0.0
300e30d6dc55e6d5cfb198edcb7ba92566fda140     191161.195 191161.195000       0.0
00c69d08d7bdd09a4dfab2296bfd6e3037658425    232265.7425 232265.742500       0.0
55ea152e1773f96de8d7991b1b29131923a088ea       129260.0 129260.000000       0.0
fdc69f00b7a48fc0e614508f9f6b14a4cf534966        96180.0  96180.000000       0.0
1ab63e900365d3e9f1d218c5c37ea223e83026d6       109500.0 109500.000000       0.0

================================================================================
[D] MASS BALANCE en GOLD (sum ML1 grado/día vs target)
================================================================================
count           623.0
mean      3686.387597
std      10596.325795
min               0.0
50%               0.0
90%      17442.363509
95%      29430.779303
99%      50046.761726
max      70771.169798
max_abs_diff_ml1_vs_proy=70771.170

Top 20 ciclos peor diff (GOLD vs proy_any):
                                ciclo_id       ml1_sum      base_sum       proy_any  abs_diff_ml1_vs_proy
acd13dedddafdc1961d7d9cc91800bfa6098f694 223126.104202 223126.104202     293897.274          70771.169798
75b2dd3962d06553eb95f9ae8c85d9bc93866623 126243.458904 126243.458904  182056.456067          55812.997162
51f871efc603e2c334a7264900ebb83d000b982b 178928.774947 178928.774947      233548.95          54620.175053
56b50ecf65ef71fa86673ff85281fe98791d40f5 178728.240304 178728.240304     231281.743          52553.502696
5d28b5c87895bccf325fe913ff54a847472c9259 183968.077682 183968.077682     235921.235          51953.157318
00c69d08d7bdd09a4dfab2296bfd6e3037658425 181117.575783 181117.575783    232265.7425          51148.166717
5fc271b62c6cd39969efb03c99202bf60f606443 181382.675996 181382.675996      232395.97          51013.294004
4c946fda9f6e0457b4ebfbe2db44219980f8b4e3 139831.711615 139831.711615  186451.677083          46619.965468
36a9de5bddb6ab125ed9ed05b3005e2a02fafac9 168122.093901 168122.093901    214514.5716          46392.477699
59383baea229684244c5595b097220128a87fd60 159575.955117 159575.955117   205389.04155          45813.086433
629099e09408057f9ed6527717fd1845ad1ee50b 134345.136434 134345.136434    179332.8075          44987.671066
3954d5106f3d522d62f823b053f226863ab0660f 185648.500212 185648.500212   230161.66975          44513.169538
e6dda64356ffd47c87837ad6ef2850248800c900 136151.642612 136151.642612       180580.4          44428.757388
34fb34e66f34909594b2aee8373c166c463c33f3 136360.642234 136360.642234     179399.385          43038.742766
0d3439617597a3498803990f5e190ffa9eac7909 134492.349140 134492.349140       175619.4           41127.05086
a0d44cd2781a89be67933af30f45d99d964f3a0c 120260.126081 120260.126081  160676.833139          40416.707059
88f481ae97d74b88cf73af301fed16ffb3d5ad34 108751.263836 108751.263836  148981.396667          40230.132831
3e18b9cd6524acc4b8b4cc7bee66d4330af36143 116764.917685 116764.917685       156705.0          39940.082315
5642697878cf99e65c5e7e6ae931b1993a4d06e9 119129.553080 119129.553080    157732.2468           38602.69372
fc11c885eaa32184fccf310962c7a5edb2930776 140438.049593 140438.049593      178606.89          38168.840407
